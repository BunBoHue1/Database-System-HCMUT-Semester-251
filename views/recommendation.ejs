<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Recommendation</title>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body class="bg-gray-100 min-h-screen p-10">
    <div class="max-w-7xl mx-auto">
      <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold text-orange-600 flex items-center gap-2">
          Recommended shopping
        </h1>
        <a href="/" class="text-gray-600 hover:text-orange-500 font font-medium"
          >Back to Home</a
        >
      </div>

      <div
        class="bg-white p-6 rounded-xl shadow-sm mb-10 border border-gray-100"
      >
        <form
          action="/recommendation"
          method="get"
          class="flex flex-wrap gap-4 items-end"
        >
          <div>
            <label
              for="User_ID"
              class="block text-gray-700 text-sm font-bold mb-2"
              >User ID</label
            >
            <input
              name="customerId"
              value="<%= query.customerId %>"
              type="text"
              class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-700 w-48 focus:ring-2 focus:ring-orange-400 focus:border-transparent transition"
            />
          </div>

          <div>
            <label class="block text-gray-700 text-sm font-bold mb-2"
              >Number of items</label
            >
            <input
              name="limit"
              value="<%= query.limit %>"
              type="number"
              min="1"
              max="50"
              class="shadow-sm border border-gray-300 rounded-lg py-2.5 px-4 text-gray-700 w-48 focus:ring-2 focus:ring-orange-400 focus:border-transparent transition"
            />
          </div>
          <button
            type="submit"
            class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2.5 px-6 rounded-lg shadow-md transition transform hover:-translate-y-0.5"
          >
            Analyzing
          </button>
        </form>
      </div>
      <% if (error) {%>
      <div
        class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 mb-8 rounded-r"
        role="alert"
      >
        <p class="font-bold">Error:</p>
        <p><%= error %></p>
      </div>
      <% } %> <% if (products && products.length > 0) { %>
      <h2 class="text-xl font-bold text-gray-800 mb-4">
        Result: Found <%= products.length %> product available
      </h2>

      <div
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
      >
        <% products.forEach(function(p) { %>
        <div
          class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition duration-300 border border-gray-100 flex flex-col"
        >
          <div
            class="h-48 bg-gray-200 flex items-center justify-center relative"
          >
            <span class="text-4xl">ðŸ“¦</span>
            <% if (p.rating >= 4.5) { %>
            <span
              class="absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded"
              >High rating</span
            >
            <% } %>
          </div>

          <div class="p-5 flex-1 flex flex-col">
            <div class="text-xs text-gray-500 mb-1 uppercase tracking-wide">
              <%= p.categoryName %>
            </div>
            <h3
              class="font-bold text-gray-900 text-lg mb-2 line-clamp-2 leading-snug"
            >
              <%= p.productName %>
            </h3>

            <div class="flex items-center mb-3">
              <span class="text-yellow-400 text-lg mr-1">â˜…</span>
              <span class="font-bold text-gray-700"><%= p.rating %></span>
              <span class="text-gray-400 text-sm ml-1">/5.0</span>
              <span class="mx-2 text-gray-300">|</span>
              <span class="text-xs text-gray-500"
                >Sold <%= p.soldAmount %></span
              >
            </div>

            <p class="text-gray-600 text-sm mb-4 line-clamp-3 flex-1">
              <%= p.description %>
            </p>

            <div
              class="mt-auto pt-4 border-t border-gray-100 flex justify-between items-center"
            >
              <span class="text-orange-600 font-extrabold text-xl">
                <%=p.price%> VND
              </span>
            </div>
          </div>
        </div>
        <% }) %>
      </div>
      <% } else if (query.customerId) { %>
      <div
        class="text-center py-20 bg-white rounded-xl border border-dashed border-gray-300"
      >
        <p class="text-gray-500 text-lg">
          Not found items, please try another ID customer
        </p>
      </div>
      <% } %>
    </div>
  </body>
</html>
